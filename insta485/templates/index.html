<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>insta485</title>
    <link rel="stylesheet" href="/css/style.css" />
  </head>
  <body>
    <header>
      <nav>
        <a href="/" class="brand">insta485</a>
        <a href="/explore/">explore</a>
        <a href="/users/{{ logname }}/">{{ logname }}</a>
      </nav>
      <hr />
    </header>

    <main>
      {% for post in posts %} {% set owner = post.owner %}
      <!--{% set post_url =
      post.url if post.url is not none else ('/posts/' ~ (post.postid|string) ~
      '/') %} -->
      {% set post_url = post.url or ('/posts/' ~ post.postid ~ '/') %} {% set
      likes = (post.likes if post.likes is not none else (post.num_likes if
      post.num_likes is not none else 0)) %}
      <article class="post">
        <header class="post-header">
          <a href="/users/{{ owner }}/">
            <img
              src="{{ post.owner_img_url or post.owner_img }}"
              alt="{{ owner }} profile"
              style="height: 32px; vertical-align: middle"
            />
          </a>
          <a href="/users/{{ owner }}/" class="owner">{{ owner }}</a>
          <a href="{{ post_url }}" class="timestamp"
            >{{ post.timestamp or post.created }}</a
          >
        </header>

        <figure>
          <img
            src="{{ post.img_url }}"
            alt="post image"
            style="max-width: 100%; height: auto"
          />
        </figure>

        <section class="meta">
          <div class="likes">
            {{ likes }} {{ 'like' if likes == 1 else 'likes' }}
          </div>
          <ul class="comments">
            {% for c in (post.comments or []) %}
            <li>
              <a href="/users/{{ c.owner }}/">{{ c.owner }}</a> {{ c.text }}
            </li>
            {% endfor %}
          </ul>
        </section>
        <hr />
      </article>
      {% endfor %}
    </main>
  </body>
</html>
